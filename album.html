<!DOCTYPE html>
<!--Grupo:003, Nomes: Francisco Pimenta - 54973, Pedro Quintão - 54971, Miguel Duarte - 54941, Gonçalo Ferreira - 55166-->

<html lang="pt-pt">
    <head>
        <title>Memento</title>
        <link rel="stylesheet" type="text/css" href="styles/style.css">
        <link rel="icon" href="images/logo_Memento1.png">
        <meta charset="utf-8">
    </head>

    <body>
        <div class="container">
            <header>
                <a id="homepage-href" href="home_page.html"><img  src="https://fontmeme.com/permalink/201119/65accd916ad7ea7ffc6c7b7279901614.png" id="memento-top-left" alt="fonte-against-romance"></a>
            </header>            

            <div id="top-right-bar">

                <div id="left-top-right-bar">
                    <button id="botao-criar-album" onclick="abreNomeAlbum()">Novo</button>
                    <button id="botao-selecionar-album" onclick="enable_galeria()">Selecionar</button>
                    <button id="botao-selecionar-todos-album" onclick="selecionaTodos('album')">Selecionar Todos</button>
                </div>
                
                <div id="centro-top-bar">
                    <img src="https://fontmeme.com/permalink/201119/cccc29a8d5a122291e8ba6d829653ec4.png" alt="fonte-against-romance">
                </div>  

                <div id="right-top-right-bar">
                    <button id="botao-adicionar" >Adicionar</button>
                    <button id="botao-eliminar" onclick="open_popup_eliminar_fotografias()"><img src="images/lixo4_icon.png" width="22px" alt=""></button>
                    <button id="botao-partilhar" onclick="guardarFotosAlbum()" ><a id="href-partilhar"><img src="images/partilhar4_icon.png" width="35px" alt=""></a></button>
                </div>
          
            </div>
            

            <div id="side-bar">
                <nav id="navegador" class="menu">
                    <a href="galeria.html">Galeria <img src="images/galeria3_icon.png" style="vertical-align:middle" width="45px"  alt=""></a> 
                    <a href="importar.html">Importar <img src="images/importar3_icon.png" style="vertical-align:middle"  width="40px" alt=""></a>
                    <a id="currentpage" href="#">Álbuns <img src="images/album3_icon.png" style="vertical-align:middle"  width="50px"> </a>
                    <a href="partilhar.html">Partilhar <img src="images/partilhar4_icon.png" style="vertical-align:middle"  width="45px"></a>
                    <a href="favoritos.html">Favoritos <img src="images/favoritos3_icon.png" style="vertical-align:middle"  width="45px"></a>
                    <a  href="ajuda.html">Ajuda <img src="images/ajuda3_icon.png" style="vertical-align:middle" width="40px"></a>
                </nav>
                
                <div id="memento">
                    <img src="images/logo_Memento1.png" width="180px" alt="">
                </div>    
            </div>

            <div class="workspace">

                <div id="disposicao-albuns">
                    <table id="disposicao-albuns-tabela">
                        <tbody>
                        </tbody>
                    </table>    
                </div>

                <div class="album_modal">
                    <div class="album_modal_content">
                        <span class="close_button" onclick="closeNomeAlbum()">&times;</span>
                        <h2>Indique o nome do Álbum:</h2>
                        <form name="nomeDoAlbum">
                            <label>
                            <input type="text" name="aName" required>
                            </label>
                        </form>
                        <br>
                        <button id="botao-cancelar" onclick="closeNomeAlbum()">Cancelar</button>
                        <button id="botao-confirmar" onclick="nomeAlbumDado(); preencheTabelaAlbum();">Confirmar</button>
                    </div>                    
                </div>
                
                <div id="opcoes-album">
                    <p>As fotos do seu álbum:</p>
                    <div class="closeButton" onclick = "closeAlbumPhotos()"> &times; </div>
                </div>

                <div id="fundo-fotos-album">
                    <table id="fotos-album">
                        <tbody>
                        </tbody>
                    </table>    

                </div>

                

                <div class="popup-filtros" id="popup-filtros-album">
                        <form name="filtros">
                            <input type="checkbox" id="desfocadas" name="desfocadas" value="desfocadas">
                            <label for="desfocadas"> Desfocadas</label><br>
                            <input type="checkbox" id="localização" name="localizacao" value="localizacao">
                            <label for="localização"> Localização</label><br>
                            <input type="checkbox" id="qualidade" name="qualidade" value="qualidade">
                            <label for="qualidade"> Qualidade</label><br>
                            <input type="checkbox" id="praia" name="praia" value="praia">
                            <label for="praia"> Praia </label><br>
                            <input type="checkbox" id="dia" name="dia" value="dia">
                            <label for="dia"> Dia </label><br><br>
                        </form>
                        <button onclick="aplica_filtros()" id="botao-confirmar-filtros">Confirmar</button>
                        <button id="botao-cancelar-filtros" onclick="tiraFiltros()">Cancelar</button>
                </div>

                <div class="popup-album">
                    <button id="botao-selecionar-todas-album" onclick="selecionaTodos('popup')">Selecionar Todas</button>
                    <div class="closeButton" onclick = "closeCriaAlbum()"> &times; </div>
                    <p id="texto-cria-album">Selecione as fotografias que deseja adicionar ao seu álbum:</p>
                    <button id="botao-cancelar-selecao" onclick="closeCriaAlbum()" >Cancelar</button>
                    <button id="botao-confirmar-selecao" onclick="preencheTabelaAlbumCriado()">Confirmar</button>
                    <div class="botao-filtros" id="botao-filtros-album" onclick="openFiltros()" ><img id="imagem_filtros" src="images/filtros_icon.png" width="40" height="40"  alt=""></div>
                    <div id="fotos-adicionar-album">
                        <table id="tabela-album">
                            <tbody>
                            
                            </tbody>
                        </table>    
                    </div>
                </div>

                
    
                <div class="popupFiltrosAplicados"><p>Os seus filtros foram aplicados com sucesso!
                    <button type="button" id="botao-popup-filtros-aplicados" onclick="closePopupFiltrosAplicados()">OK</button>
                </p>               
                </div>
    
    
                <div class="popupAlbum"><p>O seu álbum foi criado com sucesso!
                    <button type="button" id="botao-popup" onclick="closePopupAlbumCriado()">OK</button>
                </p>                
                </div>
                <div id="popup-sem-fotos"><p>Ainda não tem fotos na sua galeria. Importe primeiro!</p> </div>
                

            </div>

            
        </div>
        <div class="dimmer">
        </div>
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
        <script src="scripts/album_pageScripts.js"></script>
    </body>
</html>


<!-- 
//Grupo:003, Nomes: Francisco Pimenta - 54973, Pedro Quintão - 54971, Miguel Duarte - 54941, Gonçalo Ferreira - 55166

"use strict";

$(document).ready(showPhotos());
$(document).ready(preencheTabelaImagens());

localStorage.removeItem("fotosPartilhar");
localStorage.removeItem("fotosAlbum");

$("#right-top-right-bar button img").addClass("disabled-image-button")
document.getElementById("botao-eliminar").disabled = true;
document.getElementById("botao-criar-galeria").disabled = true;
document.getElementById("botao-adicionar").disabled = true;
$("input[type=checkbox]").attr("disabled", true);

if (localStorage.length == 0) {
    document.getElementById("botao-selecionar-galeria").disabled = true;
    document.getElementById("botao-selecionar-todas-galeria").disabled = true;
    $("#botao-filtros-galeria").addClass("disabled-image-button");
    for (let item of document.querySelectorAll('#tabela .option-item')) {
        item.style.display = "none";
    }
} else {
    document.getElementById("botao-selecionar-galeria").disabled = false;
    document.getElementById("botao-selecionar-todas-galeria").disabled = false;
    document.getElementById("botao-filtros-galeria").disabled = false;
    $("#botao-filtros-galeria").removeClass("disabled-image-button");
}




var elementos = document.querySelectorAll('input[type=checkbox]');
for (let element of elementos) {
    element.addEventListener("change", imagem_selecionada);
}

function showPhotos() {
    $("#tabela").find(".option-item").css( "display", "block");
    if (localStorage.getItem("showPopup") == "true") {
        showPopup();
        localStorage.setItem("showPopup", "false")
    }
}         


function showPopup() {
    document.getElementsByClassName("popup")[0].style.display = "block";
    $('.popup').fadeOut(7000);
}

function imagem_selecionada() {
    
    if (document.querySelectorAll('input[type=checkbox]:checked').length > 0) {
        $("#right-top-right-bar button img").removeClass("disabled-image-button");
        $("#href-album").removeClass("disabled");
        $("#href-partilhar").removeClass("disabled");
        document.getElementById("botao-eliminar").disabled = false;    
        document.getElementById("botao-criar-galeria").disabled = false;
        document.getElementById("botao-adicionar").disabled = false;
        document.getElementById("href-album").style.color = "black";
        document.getElementById("href-partilhar").href = "partilhar.html";
        document.getElementById("href-album").href = "album.html";
        
    } else {
        $("#right-top-right-bar button img").addClass("disabled-image-button");
        $("#href-album").addClass("disabled");
        $("#href-partilhar").addClass("disabled");
        document.getElementById("botao-eliminar").disabled = true;    
        document.getElementById("botao-criar-galeria").disabled = true;
        document.getElementById("href-album").style.color = "rgb(204, 204, 204)";
        document.getElementById("botao-adicionar").disabled = true;
        document.getElementById("href-partilhar").disabled = true;
        document.getElementById("href-partilhar").href = "";
        document.getElementById("href-album").disabled = true;
        document.getElementById("href-album").href = "";
    }
}  

function seleciona_todos() {
    
    var boxes = document.getElementsByClassName("checkbox");
    if (document.querySelectorAll('input[type=checkbox]:checked').length == 0) {
        for (var x = 0; x < boxes.length; x++) {
            var obj = boxes[x];
                obj.checked = true;
                imagem_selecionada();
        }
    } else {
        for (var x = 0; x < boxes.length; x++) {
            var obj = boxes[x];
                obj.checked = false;
                imagem_selecionada();
        }
    }
}

function enable_galeria() {
    if ($("input[type=checkbox]").attr("disabled")) {
        document.getElementById("botao-selecionar-galeria").innerHTML = "Cancelar"
        $("input[type=checkbox]").attr("disabled", false);
        document.getElementById("href-partilhar").href = "partilhar.html";
        document.getElementById("href-album").href = "album.html";
    } else {
        document.getElementById("botao-selecionar-galeria").innerHTML = "Selecionar"
        $("input[type=checkbox]").attr("disabled", true);
        document.getElementById("botao-criar-galeria").disabled = true;
        document.getElementById("botao-adicionar").disabled = true;
        document.getElementById("botao-eliminar").disabled = true;
        document.getElementById("botao-partilhar").disabled = true;
        document.getElementById("href-partilhar").disabled = true;
        document.getElementById("href-album").disabled = true; 
        document.getElementById("href-album").style.color = "rgb(204, 204, 204)";
        $("#href-album").addClass("disabled");
        $("#href-partilhar").addClass("disabled");
        $("#right-top-right-bar button img").addClass("disabled-image-button");
        

        for (let imagem of document.querySelectorAll('input[type=checkbox]:checked')) {
            imagem.checked = false; 
        }   
    }
}

function open_popup_eliminar_fotografias() {
    document.getElementsByClassName("dimmer")[0].style.opacity="1"
    document.getElementById("popup-eliminar-fotos-galeria").style.display = "block";   
}

function close_popup_eliminar_fotografias() {
    document.getElementsByClassName("dimmer")[0].style.opacity="0"
    document.getElementById("popup-eliminar-fotos-galeria").style.display = "none";
}

function open_popup_adicionar_fotografias() {
    document.getElementsByClassName("dimmer")[0].style.opacity="1"
    document.getElementById("popup-adicionar-fotos-galeria").style.display = "block";   
}

function close_popup_adicionar_fotografias() {
    document.getElementsByClassName("dimmer")[0].style.opacity="0"
    document.getElementById("popup-adicionar-fotos-galeria").style.display = "none";
    document.getElementById("popup-adicionar-fotos-galeria").style.display = "none";
}


function nova_galeria_eliminada() {
    var arrayFicar = document.querySelectorAll('input[type=checkbox]:not(:checked)');
    var arrayApagar = document.querySelectorAll('input[type=checkbox]:checked');
    console.log(arrayFicar)
    console.log(arrayApagar)
    var tabela = document.querySelector("#tabela tbody");
    var arraySrc = [];
    tabela.innerHTML = "";
    var x = 0;
    var i = 0;
    var trElement;
    /* Cria tabela que vai conter as fotos que vão ficar no album */
    var arrayFicarlength = arrayFicar.length;
    console.log(arrayFicarlength)
    for (let input of arrayFicar ) {
        if (x <= arrayFicarlength - 6) {
            if(i%4 == 0 || x == 0){
                trElement = document.createElement('tr');
                trElement.setAttribute('id', `tr${x}`);
            }
            let src = input.parentElement.children[1].children[0].getAttribute('src');
            
            arraySrc.push(src);
    
            let linha = document.createElement("td");
            linha.innerHTML = "<label class='option-item'>" +
                                    "<input type='checkbox'  class='checkbox'>" +
                                    "<div class='option-inner'>" +
                                        "<img width='250px' height='155px' src='" + src + "'>" +
                                    "</div>" +
                                "</label>";
            trElement.appendChild(linha);
            tabela.appendChild(trElement);
            i++;
            x++;
        }
    }
    localStorage.setItem("imagensImportadas", JSON.stringify(arraySrc));
    
    document.getElementsByClassName("dimmer")[0].style.opacity="0"  
    close_popup_eliminar_fotografias()
    
}   

function showPopupFavoritos(){
    document.getElementsByClassName("popup")[0].style.display = "block";
    $('.popup').fadeOut(7000);
    
}

function guardarFavoritos() {

    localStorage.setItem("showPopupFavoritos", "true")

    if (localStorage.getItem("fotosFavoritas") == null) {
        let srcList = [];

        for (let input of document.querySelectorAll('input[type=checkbox]:checked')) {
            let srcImagem = input.parentElement.children[1].children[0].getAttribute('src');
            srcList.push(srcImagem)
        }

        localStorage.setItem("fotosFavoritas", JSON.stringify(srcList))
    } else {

        let srcList = JSON.parse(localStorage.getItem("fotosFavoritas"));

        for (let input of document.querySelectorAll('input[type=checkbox]:checked')) {
            let srcImagem = input.parentElement.children[1].children[0].getAttribute('src');
            srcList.push(srcImagem)
        }
    
        localStorage.setItem("fotosFavoritas", JSON.stringify(srcList))

   
        


    
    }
}

function guardarFotosPartilhar() {

    let srcList = [];

    for (let input of document.querySelectorAll('input[type=checkbox]:checked')) {
        let srcImagem = input.parentElement.children[1].children[0].getAttribute('src');
        srcList.push(srcImagem)
    }

    localStorage.setItem("fotosPartilhar", JSON.stringify(srcList))
    
}

function guardarFotosAlbum() {

    if (localStorage.getItem("fotosAlbum") == null) {
        let srcList = [];

        for (let input of document.querySelectorAll('input[type=checkbox]:checked')) {
            let srcImagem = input.parentElement.children[1].children[0].getAttribute('src');
            srcList.push(srcImagem)
        }

        localStorage.setItem("fotosAlbum", JSON.stringify(srcList))
    } else {
        let srcList = JSON.parse(localStorage.getItem("fotosAlbum"));

        for (let input of document.querySelectorAll('input[type=checkbox]:checked')) {
            let srcImagem = input.parentElement.children[1].children[0].getAttribute('src');
            srcList.push(srcImagem)
        }
    
        localStorage.setItem("fotosAlbum", JSON.stringify(srcList))
    }
}




function preencheTabelaImagens() {

    if (JSON.parse(localStorage.getItem("imagensImportadas"))) {
        var tabela = document.querySelector("#tabela tbody");
        tabela.innerHTML = "";
        let arrayImagens = JSON.parse(localStorage.getItem("imagensImportadas"));
        var x = 0;
        var i = 0;
        var trElement;

        for (let imagens of arrayImagens) {
                if(i%4 == 0 || x == 0){
                    trElement = document.createElement('tr');
                    trElement.setAttribute('id', `tr${x}`);
                    x++;
                }

                let linha = document.createElement("td");
                linha.innerHTML = "<label class='option-item'>" +
                                    "<input type='checkbox'  class='checkbox'>" +
                                    "<div class='option-inner'>" +
                                        "<img width='250px' height='155px' src='" + imagens + "'>" +
                                    "</div>" +
                                "</label>";
                trElement.appendChild(linha);
                tabela.appendChild(trElement);
                i++;

                }

        document.getElementsByClassName("dimmer")[0].style.opacity="0"

        close_popup_eliminar_fotografias()    
    }
}


function preencheTabelaAlbumCriado() {
    var arrayImagensGuardadas = document.querySelectorAll('input[type=checkbox]:checked');
    var tabela = document.querySelector("#fotos-album tbody");
    tabela.innerHTML = "";
    var x = 0;
    var i = 0;
    var trElement;
    /* Cria tabela que vai conter as fotos que vão ficar no album */
    for (let input of arrayImagensGuardadas) {
            
        if(i%4 == 0 || x == 0){
            trElement = document.createElement('tr');
            trElement.setAttribute('id', `tr${x}`);
            x++;
        }

        let src = input.parentElement.children[1].children[0].getAttribute('src');
        let linha = document.createElement("td");
        linha.innerHTML = "<label class='option-item-album'>" +
                                "<input type='checkbox'  class='checkbox-album'>" +
                                "<div class='option-inner-album'>" +
                                    "<img width='220px' height='140px' src='" + src + "'>" +
                                "</div>" +
                            "</label>";
        trElement.appendChild(linha);
        tabela.appendChild(trElement);
        i++; 
        localStorage.setItem("capa_album", src);

         
    }
    
    document.getElementsByClassName("dimmer")[0].style.opacity="0"; 
   
}

function trocaCSS() {
    document.getElementById("estilos-css").href = "styles/style_darkmode.css"
}

function openFiltros() {
    
    document.getElementById("imagem_filtros").src = "images/filtros_icon1.png";
    if ( document.getElementById("popup-filtros-galeria").style.display == "block" ) {
        document.getElementById("popup-filtros-galeria").style.display = "none";
        document.getElementById("imagem_filtros").src = "images/filtros_icon.png";
        $("input[type=checkbox]").attr("disabled", true);
    } else {
        document.getElementById("popup-filtros-galeria").style.display = "block";
        $("input[type=checkbox]").attr("disabled", false);
    }
}

function tiraFiltros() {
    $("input[type=checkbox]").attr("disabled", false);
    document.getElementById("imagem_filtros").src = "images/filtros_icon.png";
    document.getElementById("popup-filtros-galeria").style.display = "none";
}

function aplica_filtros() {

    let imagensFiltradas = []  
    let filtrosDesejados = [] 
    var listFiltrosToParse = localStorage.getItem("imagensFiltros")
    var listFiltrosImgs = JSON.parse(listFiltrosToParse);
    console.log(listFiltrosImgs)
    //variavel tem o valor de true ou false consoante esteja selecionada ou nao
    var checkboxDesfocadas = document.getElementById("desfocadas").checked; 
    var checkboxLocalização = document.getElementById("localização").checked;
    var checkboxQualidade = document.getElementById("qualidade").checked;
    var checkboxPraia = document.getElementById("praia").checked;
    var checkboxDia = document.getElementById("dia").checked;

    localStorage.setItem("desfocadas", checkboxDesfocadas)
    localStorage.setItem("localização", checkboxLocalização)
    localStorage.setItem("qualidade", checkboxQualidade)
    localStorage.setItem("praia", checkboxPraia)
    localStorage.setItem("dia", checkboxDia)

    if(localStorage.getItem("desfocadas") == "true"){    
        filtrosDesejados.push("desfocadas")
        console.log(filtrosDesejados)
        console.log(listFiltrosImgs)
        for(let img = 0; img < listFiltrosImgs.length; img++) {
            let imageToCheck = listFiltrosImgs[img]["desfocadas"];
            if(imageToCheck == "true"){
                imagensFiltradas.push(listFiltrosImgs[img])
                console.log(imagensFiltradas)
            }
        }
    }
        if(localStorage.getItem("localização") == "true"){
            filtrosDesejados.push("localização")
        }
            if(localStorage.getItem("qualidade") == "true"){
               filtrosDesejados.push("qualidade")
            }
                if(localStorage.getItem("praia") == "true"){
                    filtrosDesejados.push("praia")
                    for(let img = 0; img < listFiltrosImgs.length; img++) {
                        let imageToCheck = listFiltrosImgs[img]["praia"];
                        if(imageToCheck == "true"){
                            imagensFiltradas.push(listFiltrosImgs[img]);
                        }
                    }                       
                }
                    if(localStorage.getItem("dia") == "true"){
                        filtrosDesejados.push("dia")
                        for(let img = 0; img < listFiltrosImgs.length; img++) {
                            let imageToCheck = listFiltrosImgs[img]["dia"];
                            if(imageToCheck == "true"){
                                imagensFiltradas.push(listFiltrosImgs[img])
                            }
                        }
                    }

    if(filtrosDesejados.length != 0) {
        var tabela = document.querySelector("#tabela tbody");
        tabela.innerHTML=" ";   
        var x = 0
        var trElement;
        for(var i = 0; i < imagensFiltradas.length; i++){
            if(i % 4 == 0 || x == 0){
                trElement = document.createElement('tr');
                trElement.setAttribute('id', "tr${x}");
                x++
            }

            let srcImg = imagensFiltradas[i]["imgSrcObj"]; 
            let linha = document.createElement("td");
            linha.innerHTML = "<label class='option-item'>" +
                                "<input type='checkbox'  class='checkbox'>" +
                                "<div class='option-inner'>" +
                                    "<img width='250px' height='155px' src='" + srcImg + "'>" +
                                "</div>" +
                            "</label>";
                       
            trElement.appendChild(linha);
            tabela.appendChild(trElement);
        }
    }else{
        var tabela = document.querySelector("#tabela tbody");
        tabela.innerHTML=" ";   
        var x = 0
        var trElement;
        for(var i = 0; i < listFiltrosImgs.length; i++){
            if(i % 4 == 0 || x == 0){
                trElement = document.createElement('tr');
                trElement.setAttribute('id', "tr${x}");
                x++
            }

            let srcImg = listFiltrosImgs[i]["imgSrcObj"]; 
            let linha = document.createElement("td");
            linha.innerHTML = "<label class='option-item'>" +
                                "<input type='checkbox'  class='checkbox'>" +
                                "<div class='option-inner'>" +
                                    "<img width='250px' height='155px' src='" + srcImg + "'>" +
                                "</div>" +
                            "</label>";
                       
            trElement.appendChild(linha);
            tabela.appendChild(trElement)
        }
        
    }
    checkboxDesfocadas = document.getElementById("desfocadas").checked = false;
    checkboxLocalização = document.getElementById("localização").checked = false;
    checkboxQualidade = document.getElementById("qualidade").checked = false;
    checkboxPraia = document.getElementById("praia").checked = false;
    checkboxDia = document.getElementById("dia").checked = false;
    $("input[type=checkbox]").attr("disabled", true);
    document.getElementById("imagem_filtros").src = "images/filtros_icon.png";
    document.getElementsByClassName("popupFiltrosAplicados")[0].style.display = "block"
    document.getElementById("popup-filtros-galeria").style.display = "none" 
    $('.popupFiltrosAplicados').fadeOut(7000);
}



 -->
















































<!-- 


//Grupo:003, Nomes: Francisco Pimenta - 54973, Pedro Quintão - 54971, Miguel Duarte - 54941, Gonçalo Ferreira - 55166

"use strict";

$(document).ready(showPhotos());
$(document).ready(preencheTabelaImagens());

localStorage.removeItem("fotosPartilhar");
localStorage.removeItem("fotosAlbum");

$("#right-top-right-bar button img").addClass("disabled-image-button")
document.getElementById("botao-eliminar").disabled = true;
document.getElementById("botao-criar-galeria").disabled = true;
document.getElementById("botao-adicionar").disabled = true;
$("input[type=checkbox]").attr("disabled", true);

if (localStorage.length == 0) {
    document.getElementById("botao-selecionar-galeria").disabled = true;
    document.getElementById("botao-selecionar-todas-galeria").disabled = true;
    $("#botao-filtros-galeria").addClass("disabled-image-button");
    for (let item of document.querySelectorAll('#tabela .option-item')) {
        item.style.display = "none";
    }
} else {
    document.getElementById("botao-selecionar-galeria").disabled = false;
    document.getElementById("botao-selecionar-todas-galeria").disabled = false;
    document.getElementById("botao-filtros-galeria").disabled = false;
    $("#botao-filtros-galeria").removeClass("disabled-image-button");
}




var elementos = document.querySelectorAll('input[type=checkbox]');
for (let element of elementos) {
    element.addEventListener("change", imagem_selecionada);
}

function showPhotos() {
    $("#tabela").find(".option-item").css( "display", "block");
    if (localStorage.getItem("showPopup") == "true") {
        showPopup();
        localStorage.setItem("showPopup", "false")
    }
}         

function showPopup() {
    document.getElementsByClassName("popup")[0].style.display = "block";
    $('.popup').fadeOut(7000);
}

function imagem_selecionada() {
    
    if (document.querySelectorAll('input[type=checkbox]:checked').length > 0) {
        $("#right-top-right-bar button img").removeClass("disabled-image-button");
        document.getElementById("botao-eliminar").disabled = false;    
        document.getElementById("botao-criar-galeria").disabled = false;
        document.getElementById("botao-adicionar").disabled = false;
        document.getElementById("href-partilhar").href = "partilhar.html";
        document.getElementById("href-album").href = "album.html";
        
    } else {
        $("#right-top-right-bar button img").addClass("disabled-image-button");
        document.getElementById("botao-eliminar").disabled = true;    
        document.getElementById("botao-criar-galeria").disabled = true;
        document.getElementById("botao-adicionar").disabled = true;
        document.getElementById("href-partilhar").disabled = true;
        document.getElementById("href-partilhar").href = "";
        document.getElementById("href-album").disabled = true;
        document.getElementById("href-album").href = "";
    }
}  

function seleciona_todos() {
    
    var boxes = document.getElementsByClassName("checkbox");
    if (document.querySelectorAll('input[type=checkbox]:checked').length == 0) {
        for (var x = 0; x < boxes.length; x++) {
            var obj = boxes[x];
                obj.checked = true;
                imagem_selecionada();
        }
    } else {
        for (var x = 0; x < boxes.length; x++) {
            var obj = boxes[x];
                obj.checked = false;
                imagem_selecionada();
        }
    }
}

function enable_galeria() {
    if ( $("input[type=checkbox]").attr("disabled")) {
        document.getElementById("botao-selecionar-galeria").innerHTML = "Cancelar"
        $("input[type=checkbox]").attr("disabled", false);
        document.getElementById("href-partilhar").href = "partilhar.html";
        document.getElementById("href-album").href = "album.html";
    } else {
        document.getElementById("botao-selecionar-galeria").innerHTML = "Selecionar"
        $("input[type=checkbox]").attr("disabled", true);
        document.getElementById("botao-criar-galeria").disabled = true;
        document.getElementById("botao-adicionar").disabled = true;
        document.getElementById("botao-eliminar").disabled = true;
        document.getElementById("botao-partilhar").disabled = true;
        document.getElementById("href-partilhar").disabled = true;
        document.getElementById("href-album").disabled = true;
        document.getElementById("href-partilhar").href = "";   
        document.getElementById("href-album").href = "";   
        $("#right-top-right-bar button img").addClass("disabled-image-button");
        

        for (let imagem of document.querySelectorAll('input[type=checkbox]:checked')) {
            imagem.checked = false; 
        }   
    }
}

function open_popup_eliminar_fotografias() {
    document.getElementsByClassName("dimmer")[0].style.opacity="1"
    document.getElementById("popup-eliminar-fotos-galeria").style.display = "block";   
}

function close_popup_eliminar_fotografias() {
    document.getElementsByClassName("dimmer")[0].style.opacity="0"
    document.getElementById("popup-eliminar-fotos-galeria").style.display = "none";
}

function open_popup_adicionar_fotografias() {
    document.getElementsByClassName("dimmer")[0].style.opacity="1"
    document.getElementById("popup-adicionar-fotos-galeria").style.display = "block";   
}

function close_popup_adicionar_fotografias() {
    document.getElementsByClassName("dimmer")[0].style.opacity="0"
    document.getElementById("popup-adicionar-fotos-galeria").style.display = "none";
    document.getElementById("popup-adicionar-fotos-galeria").style.display = "none";
}


function nova_galeria_eliminada() {
    var arrayFicar = document.querySelectorAll('#input[type=checkbox]:not(:checked)');
    var tabela = document.querySelector("#tabela tbody");
    var arraySrc = [];
    tabela.innerHTML = "";
    var x = 0;
    var i = 0;
    var trElement;
    console.log(arrayFicar)
    /* Cria tabela que vai conter as fotos que vão ficar no album */

    for (let input of arrayFicar ) {
        
        if (x < arrayFicar.length - 5) {
            
            if(i%4 == 0 || x == 0){
                trElement = document.createElement('tr');
                
            }

            
            let src = input.parentElement.children[1].children[0].getAttribute('src');

            arraySrc.push(src);

            let linha = document.createElement("td");
            linha.innerHTML = "<label class='option-item'>" +
                                    "<input type='checkbox' class='checkbox'>" +
                                    "<div class='option-inner'>" +
                                        "<img width='250px' height='155px' src='" + src + "'>" +
                                    "</div>" +
                                "</label>";
            trElement.appendChild(linha);
            tabela.appendChild(trElement);
            i++;  
        }
        x++;
        
    }
    
    localStorage.setItem("imagensImportadas", JSON.stringify(arraySrc));

    document.getElementsByClassName("dimmer")[0].style.opacity="0"  
    
    close_popup_eliminar_fotografias()
}   

function showPopupFavoritos(){
    document.getElementsByClassName("popup")[0].style.display = "block";
    $('.popup').fadeOut(7000);
    
}

function guardarFavoritos() {

    localStorage.setItem("showPopupFavoritos", "true")
    
    if (localStorage.getItem("fotosFavoritas") == null) {
        let srcList = [];

        for (let input of document.querySelectorAll('input[type=checkbox]:checked')) {
            let srcImagem = input.parentElement.children[1].children[0].getAttribute('src');
            srcList.push(srcImagem)
        }

        localStorage.setItem("fotosFavoritas", JSON.stringify(srcList))
    } else {

        let srcList = JSON.parse(localStorage.getItem("fotosFavoritas"));

        for (let input of document.querySelectorAll('input[type=checkbox]:checked')) {
            let srcImagem = input.parentElement.children[1].children[0].getAttribute('src');
            srcList.push(srcImagem)
        }
    
        localStorage.setItem("fotosFavoritas", JSON.stringify(srcList))

    }
}

function guardarFotosPartilhar() {

    let srcList = [];

    for (let input of document.querySelectorAll('input[type=checkbox]:checked')) {
        let srcImagem = input.parentElement.children[1].children[0].getAttribute('src');
        srcList.push(srcImagem)
    }

    localStorage.setItem("fotosPartilhar", JSON.stringify(srcList))
    
}

function guardarFotosAlbum() {

    if (localStorage.getItem("fotosAlbum") == null) {
        let srcList = [];

        for (let input of document.querySelectorAll('input[type=checkbox]:checked')) {
            let srcImagem = input.parentElement.children[1].children[0].getAttribute('src');
            srcList.push(srcImagem)
        }

        localStorage.setItem("fotosAlbum", JSON.stringify(srcList))
    } else {
        let srcList = JSON.parse(localStorage.getItem("fotosAlbum"));

        for (let input of document.querySelectorAll('input[type=checkbox]:checked')) {
            let srcImagem = input.parentElement.children[1].children[0].getAttribute('src');
            srcList.push(srcImagem)
        }
    
        localStorage.setItem("fotosAlbum", JSON.stringify(srcList))
    }
}




function preencheTabelaImagens() {

    if (JSON.parse(localStorage.getItem("imagensImportadas"))) {
        var tabela = document.querySelector("#tabela tbody");
        tabela.innerHTML = "";
        let arrayImagens = JSON.parse(localStorage.getItem("imagensImportadas"));
        var x = 0;
        var i = 0;
        var trElement;

        for (let imagens of arrayImagens) {
                if(i%4 == 0 || x == 0){
                    trElement = document.createElement('tr');
                    x++;
                }

                let linha = document.createElement("td");
                linha.innerHTML = "<label class='option-item'>" +
                                    "<input type='checkbox' class='checkbox'>" +
                                    "<div class='option-inner'>" +
                                        "<img width='250px' height='155px' src='" + imagens + "'>" +
                                    "</div>" +
                                "</label>";
                trElement.appendChild(linha);
                tabela.appendChild(trElement);
                i++;

        }

        document.getElementsByClassName("dimmer")[0].style.opacity="0"

        close_popup_eliminar_fotografias()    
    }
}


function preencheTabelaAlbumCriado() {
    var arrayImagensGuardadas = document.querySelectorAll('input[type=checkbox]:checked');
    var tabela = document.querySelector("#fotos-album tbody");
    tabela.innerHTML = "";
    var x = 0;
    var i = 0;
    var trElement;
    /* Cria tabela que vai conter as fotos que vão ficar no album */
    for (let input of arrayImagensGuardadas) {
            
        if(i%4 == 0 || x == 0){
            trElement = document.createElement('tr');
            x++;
        }

        let src = input.parentElement.children[1].children[0].getAttribute('src');
        let linha = document.createElement("td");
        linha.innerHTML = "<label class='option-item-album'>" +
                                "<input type='checkbox' class='checkbox-album'>" +
                                "<div class='option-inner-album'>" +
                                    "<img width='220px' height='140px' src='" + src + "'>" +
                                "</div>" +
                            "</label>";
        trElement.appendChild(linha);
        tabela.appendChild(trElement);
        i++; 
        localStorage.setItem("capa_album", src);

         
    }
    
    document.getElementsByClassName("dimmer")[0].style.opacity="0"; 
   
}

function trocaCSS() {
    document.getElementById("estilos-css").href = "styles/style_darkmode.css"
}

function openFiltros() {
    
    document.getElementById("imagem_filtros").src = "images/filtros_icon1.png";
    if ( document.getElementById("popup-filtros-galeria").style.display == "block" ) {
        document.getElementById("popup-filtros-galeria").style.display = "none";
        document.getElementById("imagem_filtros").src = "images/filtros_icon.png";
        $("input[type=checkbox]").attr("disabled", true);
    } else {
        document.getElementById("popup-filtros-galeria").style.display = "block";
        $("input[type=checkbox]").attr("disabled", false);
    }
}

function tiraFiltros() {
    $("input[type=checkbox]").attr("disabled", false);
    document.getElementById("imagem_filtros").src = "images/filtros_icon.png";
    document.getElementById("popup-filtros-galeria").style.display = "none";
}

function aplica_filtros() {

    let imagensFiltradas = []  
    let filtrosDesejados = [] 
    var listFiltrosToParse = localStorage.getItem("imagensFiltros")
    var listFiltrosImgs = JSON.parse(listFiltrosToParse);
    console.log(listFiltrosImgs)
    //variavel tem o valor de true ou false consoante esteja selecionada ou nao
    var checkboxDesfocadas = document.getElementById("desfocadas").checked; 
    var checkboxLocalização = document.getElementById("localização").checked;
    var checkboxQualidade = document.getElementById("qualidade").checked;
    var checkboxPraia = document.getElementById("praia").checked;
    var checkboxDia = document.getElementById("dia").checked;

    localStorage.setItem("desfocadas", checkboxDesfocadas)
    localStorage.setItem("localização", checkboxLocalização)
    localStorage.setItem("qualidade", checkboxQualidade)
    localStorage.setItem("praia", checkboxPraia)
    localStorage.setItem("dia", checkboxDia)

    if(localStorage.getItem("desfocadas") == "true"){    
        filtrosDesejados.push("desfocadas")
        console.log(filtrosDesejados)
        console.log(listFiltrosImgs)
        for(let img = 0; img < listFiltrosImgs.length; img++) {
            let imageToCheck = listFiltrosImgs[img]["desfocadas"];
            if(imageToCheck == "true"){
                imagensFiltradas.push(listFiltrosImgs[img])
                console.log(imagensFiltradas)
            }
        }
    }
        if(localStorage.getItem("localização") == "true"){
            filtrosDesejados.push("localização")
        }
            if(localStorage.getItem("qualidade") == "true"){
               filtrosDesejados.push("qualidade")
            }
                if(localStorage.getItem("praia") == "true"){
                    filtrosDesejados.push("praia")
                    for(let img = 0; img < listFiltrosImgs.length; img++) {
                        let imageToCheck = listFiltrosImgs[img]["praia"];
                        if(imageToCheck == "true"){
                            imagensFiltradas.push(listFiltrosImgs[img]);
                        }
                    }                       
                }
                    if(localStorage.getItem("dia") == "true"){
                        filtrosDesejados.push("dia")
                        for(let img = 0; img < listFiltrosImgs.length; img++) {
                            let imageToCheck = listFiltrosImgs[img]["dia"];
                            if(imageToCheck == "true"){
                                imagensFiltradas.push(listFiltrosImgs[img])
                            }
                        }
                    }

    if(filtrosDesejados.length != 0) {
        var tabela = document.querySelector("#tabela tbody");
        tabela.innerHTML=" ";   
        var x = 0
        var trElement;
        for(var i = 0; i < imagensFiltradas.length; i++){
            if(i % 4 == 0 || x == 0){
                trElement = document.createElement('tr');
                x++
            }

            let srcImg = imagensFiltradas[i]["imgSrcObj"]; 
            let linha = document.createElement("td");
            linha.innerHTML = "<label class='option-item'>" +
                                "<input type='checkbox' class='checkbox'>" +
                                "<div class='option-inner'>" +
                                    "<img width='250px' height='155px' src='" + srcImg + "'>" +
                                "</div>" +
                            "</label>";
                       
            trElement.appendChild(linha);
            tabela.appendChild(trElement);
        }
    }else{
        var tabela = document.querySelector("#tabela tbody");
        tabela.innerHTML=" ";   
        var x = 0
        var trElement;
        for(var i = 0; i < listFiltrosImgs.length; i++){
            if(i % 4 == 0 || x == 0){
                trElement = document.createElement('tr');
                x++
            }

            let srcImg = listFiltrosImgs[i]["imgSrcObj"]; 
            let linha = document.createElement("td");
            linha.innerHTML = "<label class='option-item'>" +
                                "<input type='checkbox' class='checkbox'>" +
                                "<div class='option-inner'>" +
                                    "<img width='250px' height='155px' src='" + srcImg + "'>" +
                                "</div>" +
                            "</label>";
                       
            trElement.appendChild(linha);
            tabela.appendChild(trElement)
        }
        
    }
    checkboxDesfocadas = document.getElementById("desfocadas").checked = false;
    checkboxLocalização = document.getElementById("localização").checked = false;
    checkboxQualidade = document.getElementById("qualidade").checked = false;
    checkboxPraia = document.getElementById("praia").checked = false;
    checkboxDia = document.getElementById("dia").checked = false;
    document.getElementById("imagem_filtros").src = "images/filtros_icon.png";
    document.getElementsByClassName("popupFiltrosAplicados")[0].style.display = "block"
    document.getElementById("popup-filtros-galeria").style.display = "none" 
    $('.popupFiltrosAplicados').fadeOut(7000);
}


















/* 
Cria arrays diferentes de imagens à medida que o utlizador carrega 
no botao de "Criar" para cria diferentes albuns 
function guardarAlbumFotos() {

    var n = localStorage.getItem("contador");
    if (n == null) { 
        n = 0;
        let srcList = [];
        for (let input of document.querySelectorAll('input[type=checkbox]:checked')) {
            let srcImagem = input.parentElement.children[1].children[0].getAttribute('src');
            srcList.push(srcImagem)
        }

        localStorage.setItem(`guardaAlbumFotos${n}`, JSON.stringify(srcList));

    } else {
        n++;
        let srcList = [];
        for (let input of document.querySelectorAll('input[type=checkbox]:checked')) {
            let srcImagem = input.parentElement.children[1].children[0].getAttribute('src');
            srcList.push(srcImagem)
        }

        localStorage.setItem(`guardaAlbumFotos${n}`, JSON.stringify(srcList));
    }

    localStorage.setItem("contador",n);
   
    
} */ -->